#!/bin/bash
#seed me daddy

echo '[ * ] Processing parameters for payload retrieval'

read -e -p "Type your Facility / RHU Name (e.g. San Jose RHU): " SITE
read -e -p "Type your Province (e.g. pangasinan): " PROV
#GET EVERYTHING; STATUS; SIZE OF DISK; IP ADDRESS;


echo '[ * ] Attempting to retrieve remote payload'

curl http://sql.wah.ph/alpha_branch/script_final > /var/tmp/feather



echo '[ * ] Executing payload'
echo > ~/log.txt
sh /var/tmp/feather | tee ~/log.txt
cat <<EOT > ./config.xml
<site>
 <site>$SITE</site>
 <prov>$PROV</prov>
</site>
EOT

curl --header "Content-Type: application/json" \
  --request POST \
  --data '{"site":"$SITE","password":"$PROV"}' \
 http://sync-pd01.sql.wah.ph/upd